#!/bin/sh

#javac EdgeDetector.java

times=10
basedir="`dirname $0`/.."

#infile=Duke-Guitar.png
infile="$basedir/images/Duke-Guitar.white.png"
#infile=duke.png
#infile=test.png

outfile="$basedir/tmp/out.png"
goodfile="$basedir/tmp/good.png"

for i in 1 2 4 8 16 ; do
#for i in 1 ; do
	echo Using $i threads
	java -classpath "$basedir/build" EdgeDetector "$infile" "$outfile" $times $i | tee "$basedir/tmp/stat.$i.log"
	if ! diff "$outfile" "$goodfile" ; then
		echo DIFFERENT FILES
		exit 1
	fi
done
